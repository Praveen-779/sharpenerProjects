<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Expense tracker</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
</head>
<body>
 <div id="form">
  <form onsubmit="saveToCloud(event)">
    <label for="chooseExpenseAmount"> Choose Expense Amount :</label>
    <input type="text" id="chooseExpenseAmount" required>
    <br>
    <br>
    <label for="chooseDescription">Choose Description</label>
    <input type="text" id="chooseDescription" required>
    <br>
    <br>
    <label for="chooseACategory">Choose A Category :</label>
    <select id="chooseACategory">
        <option value="food">Food</option>
        <option value="fuel">Fuel</option>
        <option value="movie">Movie</option>
        <option value="shopping">Shopping</option>
    </select>
    <br>
    <br>
    <input type="submit" value="Add Expense">
  </form>
</div>
<div id="displayExpense">

</div>
</body>
</html>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.4.0/axios.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
<script>
   function saveToCloud(event) {
        event.preventDefault();
        let expense = document.getElementById('chooseExpenseAmount').value;
        let description = document.getElementById('chooseDescription').value;
        let category = document.getElementById('chooseACategory').value;

        let userExpense = {
            expense,
            description,
            category
        };
        
        axios.post("https://crudcrud.com/api/2e1ebabbf971434487bf1c305fafc177/expenseTracker", userExpense)
        .then((response) => {
            console.log(response.data);
            fetchExpensesFromCloud();
        })
        .catch((error) => {
            console.log(error);
        });

        document.getElementById('chooseExpenseAmount').value='';
        document.getElementById('chooseDescription').value='';
        document.getElementById('chooseACategory').value='';
    }

    function fetchExpensesFromCloud() {
        axios.get("https://crudcrud.com/api/2e1ebabbf971434487bf1c305fafc177/expenseTracker")
            .then((response) => {
                let expenses = response.data;
                // Clear the displayExpense div
                document.getElementById('displayExpense').innerHTML = '';

                // Display fetched expenses on the screen
                expenses.forEach((expense) => {
                    displayExpense(expense);
                });
            })
            .catch((error) => {
                console.log(error);
            });
    }

    window.onload = function() {
        fetchExpensesFromCloud();
    };

    function displayExpense(userExpense) {
        let displayDiv = document.getElementById('displayExpense');
        let para = document.createElement('p');
        para.textContent = 'Expense: ' + userExpense.expense + ' Description: ' + userExpense.description + ' Category: ' + userExpense.category;
        displayDiv.appendChild(para);

        let editButton = document.createElement('button');
        editButton.textContent = 'Edit Expense';
        para.appendChild(editButton);

        let deleteButton = document.createElement('button');
        deleteButton.textContent = 'Delete Expense';
        para.appendChild(deleteButton);

        
        editButton.addEventListener('click', function() {
            
        });

        deleteButton.addEventListener('click', function() {
            deleteExpense(userExpense._id); 
            displayDiv.removeChild(para);
        });
    }

    function deleteExpense(expenseId) {
        axios.delete(`https://crudcrud.com/api/2e1ebabbf971434487bf1c305fafc177/expenseTracker/${expenseId}`)
            .then((response) => {
                console.log(response.data);
            })
            .catch((error) => {
                console.log(error);
            });
    }
</script>
